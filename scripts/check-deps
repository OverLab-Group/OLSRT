#!/bin/bash
# Universal dependency checker

TARGET=$1

echo "Checking dependencies for $TARGET..."

case $TARGET in
    linux)
        # Check for GCC on Linux
        if ! command -v gcc &> /dev/null; then
            echo "Error: gcc not found. Install with: sudo apt-get install build-essential"
            exit 1
        fi
        ;;
        
    windows)
        # Check for mingw-w64 for Windows cross-compilation
        if ! command -v x86_64-w64-mingw32-gcc &> /dev/null; then
            echo "Error: mingw-w64 not found. Install with:"
            echo "  Ubuntu/Debian: sudo apt-get install mingw-w64"
            echo "  macOS: brew install mingw-w64"
            echo "  Windows: Use MSVC or install mingw-w64"
            exit 1
        fi
        ;;
        
    darwin)
        # Check for Clang/LLVM for macOS cross-compilation
        if ! command -v clang &> /dev/null; then
            echo "Error: clang not found. Install with:"
            echo "  Ubuntu/Debian: sudo apt-get install clang llvm"
            echo "  macOS: Already installed with Xcode"
            echo "  Windows: Use MSVC or install Clang"
            exit 1
        fi
        ;;
        
    bsd)
        # Check for Clang for BSD cross-compilation
        if ! command -v clang &> /dev/null; then
            echo "Error: clang not found. Install with:"
            echo "  Ubuntu/Debian: sudo apt-get install clang"
            echo "  macOS: Already installed with Xcode"
            exit 1
        fi
        ;;
esac

echo "All dependencies satisfied for $TARGET."